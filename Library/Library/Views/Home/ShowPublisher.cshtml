@if (Model != null)
{
    ViewBag.Title = "Видавець: " + Model.Name;
    @model DBLib.Models.Publisher

    <h2>
        Видавець: @Model.Name@if (User.IsInRole("admin"))
        {
            <span id="editFormShowBtn" class="btn btn-warning btn-xs glyphicon glyphicon-pencil"></span>
        }
    </h2>
    <h4>Місто: @Model.City</h4>

    if (User.IsInRole("admin"))
    {
        <div id="editForm" class="hidden">
            <input hidden id="IdInput" size="50" value="@Model.Id" />
            <input id="newNameInput" size="50" value="@Model.Name" />
            <input id="newCityInput" size="22" value="@Model.City" />
            <button id="saveChangesBtn" class="btn btn-success btn-sm">Зберегти зміни</button>
        </div>
    }

    if (Model.Books.Count > 0)
    {
        <h5 class="alertInfo bg-success text-primary">Цей видавець має <span class="badge">@Model.Books.Count</span> книг</h5>
        @*<ul>
                @foreach (var book in Model.Books)
                {
                    <li><a href="@Url.Action("ShowBook", "Home", new { id = book.Id })">@book.Title</a></li>
                }
            </ul>*@

        @Html.Partial("_BooksView", Model.Books)
    }
    else
    {
        <h5 class="alertInfo bg-warning text-primary">Це видавець не має книг</h5>
    }
}
else
{
    ViewBag.Title = "Видавці";
    <h2>Видавці</h2>

    <h4 class="alertInfo bg-success text-primary">До вашої уваги такі видавці:</h4>

    <ul>
        @foreach (var publisher in ViewBag.OtherPublishers)
        {
            <li><a href="@Url.Action("ShowPublisher", "Home", new { id = publisher.Id })">@publisher.Name</a></li>
        }
    </ul>
}

@if (User.IsInRole("admin"))
{
    @section scripts
{
        <script>
        function toggleEditForm() {
            $("#editForm").toggleClass("hidden");
        }

        function saveChanges() {
            var newName = $("#newNameInput").val();
            var newCity = $("#newCityInput").val();
            var Id = $("#IdInput").val();
            if (newName.length > 1 && newCity.length>1) {
                $.ajax({
                    url: '@Url.Action("EditPublisher", "LibraryManage")',
                    type: 'POST',
                    data: { Id: Id, Name: newName, City: newCity },
                    success: () => {
                        alert("Успішно змінено");
                        toggleEditForm();
                        toggleBlockUserBtns();
                    },
                    error: function () {
                        alert('Помилка при зміні');
                    }
                });
            }
            else {
                alert("Закоротка назва або місто");
            }
        }

            $("#editFormShowBtn").click(toggleEditForm);
            $("#saveChangesBtn").click(saveChanges);
        </script>
    }
}